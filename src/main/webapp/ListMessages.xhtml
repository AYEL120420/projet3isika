<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
	
	<h:head>
	<title>Messagerie: Index</title>
</h:head>
<h:body>
				<div id="allMsgSection">

					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>Exp√©diteur</th>
									<th>Objet</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<ui:repeat value="#{conversationController.displayMessages()}"
									var="message">
									<tr>
										<td>#{message.senderEmail}</td>
										<td>#{message.messageResume}</td>
										<td><p:commandButton value="Lire"
												action="#{conversationController.markMessageAsRead(message.id)}"
												rendered="#{not message.read}" update="messageDia"
												oncomplete="PF('messageDia').show()">
												<f:setPropertyActionListener
													target="#{conversationController.selectedMessageContent}"
													value="#{message.content}" />
											</p:commandButton></td>
									</tr>
								</ui:repeat>
							</tbody>
						</table>
						<p:dialog header="Contenu du Message" widgetVar="messageDia"
							modal="true" resizable="false" dynamic="true">
							<p:outputPanel>
								<p>#{conversationController.selectedMessageContent}</p>
							</p:outputPanel>
						</p:dialog>
					</div>
				</div>

</h:body>
</html>
	